<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Clear_Service_Resource_Shift</name>
        <label>Clear Service Resource Shift</label>
        <locationX>50</locationX>
        <locationY>791</locationY>
        <assignmentItems>
            <assignToReference>$Record.Service_Resource_Shift__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue></stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Copy_1_of_Set_Tech_Notes_Field_from_Tech_Notes_Mobile</name>
        <label>Copy 1 of Set Tech Notes Field from Tech Notes Mobile</label>
        <locationX>314</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Solution_Notes__c</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>ConcatName</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Dispatch_Scheduled_Service_Appointment</name>
        <label>Dispatch Scheduled Service Appointment</label>
        <locationX>890</locationX>
        <locationY>2687</locationY>
        <assignmentItems>
            <assignToReference>$Record.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Dispatched</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Dispatched_Color</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Pin_Service_Appointment</name>
        <label>Pin Service Appointment</label>
        <locationX>626</locationX>
        <locationY>2567</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__Pinned__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Accepted_Color</name>
        <label>Set Accepted Color</label>
        <locationX>1722</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#f8d568</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Call_Center_ATTN_Color</name>
        <label>Set Call Center ATTN Color</label>
        <locationX>2250</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#FF8300</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Call_Center_ATTN_Color_0</name>
        <label>Set Call Center ATTN Color</label>
        <locationX>314</locationX>
        <locationY>791</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#FF8300</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_Set_Tech_Notes_Field_from_Tech_Notes_Mobile</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Cannot_Complete_Color</name>
        <label>Set Cannot Complete Color</label>
        <locationX>2514</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#ff0000</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Scheduled_End_Time_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Completed_Color</name>
        <label>Set Completed Color</label>
        <locationX>1458</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#228B22</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Scheduled_End_Time</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Dispatched_Color</name>
        <label>Set Dispatched Color</label>
        <locationX>1414</locationX>
        <locationY>3383</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#9000ff</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Unpin_Service_Appointment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_En_Route_Color</name>
        <label>Set En Route Color</label>
        <locationX>930</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#89cff0</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_On_Site_Color</name>
        <label>Set On Site Color</label>
        <locationX>1194</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#FFB6C1</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Scheduled_Start_and_End_Time_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Rejected_by_and_Schedule_Over_Lower_Priority</name>
        <label>Set Rejected by and Schedule Over Lower Priority</label>
        <locationX>314</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.Rejected_By__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.FSL__Schedule_over_lower_priority_appointment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Service_Resource_Shift__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue></stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Call_Center_ATTN_Color_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_RM_ATTN_Color</name>
        <label>Set RM ATTN Color</label>
        <locationX>1986</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#FF1919</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <description>Set the Variables needed for an OT Shift on Service Appointment</description>
        <name>Set_SA_OT_Shift_Variables</name>
        <label>Set SA OT Shift Variables</label>
        <locationX>1282</locationX>
        <locationY>3743</locationY>
        <assignmentItems>
            <assignToReference>$Record.Was_Overtime_Used__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Service_Resource_Shift__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Assigned_Resource_Shift_USE.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <description>Set the Variables needed for an OT Shift on Service Appointment</description>
        <name>Set_SA_OT_Shift_Variables_0</name>
        <label>Set SA OT Shift Variables</label>
        <locationX>1546</locationX>
        <locationY>3743</locationY>
        <assignmentItems>
            <assignToReference>$Record.Was_Overtime_Used__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Service_Resource_Shift__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Assigned_Resource_Shift_USE.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Schedule_Over_Lower_Priority_to_True</name>
        <label>Set Schedule Over Lower Priority to True</label>
        <locationX>50</locationX>
        <locationY>671</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__Schedule_over_lower_priority_appointment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Clear_Service_Resource_Shift</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Scheduled_Color</name>
        <label>Set Scheduled Color</label>
        <locationX>1401</locationX>
        <locationY>1607</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__GanttColor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>#808080</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_SR_Shift_and_Schedule_Over_Lower_Priority_to_False</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Scheduled_End_Time</name>
        <label>Set Scheduled End Time</label>
        <locationX>1458</locationX>
        <locationY>791</locationY>
        <assignmentItems>
            <assignToReference>$Record.SchedEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Tech_Notes_Field_from_Tech_Notes_Mobile_Completed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Scheduled_End_Time_0</name>
        <label>Set Scheduled End Time</label>
        <locationX>2514</locationX>
        <locationY>791</locationY>
        <assignmentItems>
            <assignToReference>$Record.SchedEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Tech_Notes_Field_from_Tech_Notes_Mobile_Cannot_Complete</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Scheduled_Start_and_End_Time_0</name>
        <label>Set Scheduled Start and End Time</label>
        <locationX>1194</locationX>
        <locationY>791</locationY>
        <assignmentItems>
            <assignToReference>$Record.SchedStartTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CurrentTime</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.SchedEndTime</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>EstEndTime</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Service_Resource_Shift</name>
        <label>Set Service Resource Shift</label>
        <locationX>1121</locationX>
        <locationY>2087</locationY>
        <assignmentItems>
            <assignToReference>$Record.Service_Resource_Shift__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Assigned_Resource_Shift_USE.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Scheduled_Service_Appointments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_SR_Shift_and_Schedule_Over_Lower_Priority_to_False</name>
        <label>Set Schedule Over Lower Priority to False</label>
        <locationX>1401</locationX>
        <locationY>1727</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__Schedule_over_lower_priority_appointment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Territory_from_Service_Appointment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Tech_Notes_Field_from_Tech_Notes_Mobile_Cannot_Complete</name>
        <label>Set Tech Notes Field from Tech Notes Mobile</label>
        <locationX>2514</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Solution_Notes__c</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>ConcatName</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Tech_Notes_Field_from_Tech_Notes_Mobile_Completed</name>
        <label>Set Tech Notes Field from Tech Notes Mobile</label>
        <locationX>1458</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Solution_Notes__c</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>ConcatName</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Unpin_Service_Appointment</name>
        <label>Unpin Service Appointment</label>
        <locationX>1414</locationX>
        <locationY>3503</locationY>
        <assignmentItems>
            <assignToReference>$Record.FSL__Pinned__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Was_Shift_Found_Overtime</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Emergency_0</name>
        <label>Emergency?</label>
        <locationX>881</locationX>
        <locationY>1487</locationY>
        <defaultConnector>
            <targetReference>Set_Scheduled_Color</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Emergency_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSL__Emergency__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Current_Time_within_Assigned_Shift</name>
        <label>Is Current Time within Assigned Shift?</label>
        <locationX>1121</locationX>
        <locationY>2327</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Current_Time_within_Shift</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Flow.CurrentDateTime</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>var60minBeforeShift</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Flow.CurrentDateTime</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>Get_Assigned_Resource_Shift_USE.EndTime</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Scheduled_Service_Appointments</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Defer_to_Location_Open_Time_Set_to_True</targetReference>
            </connector>
            <label>Current Time within Shift</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Defer_to_Location_Open_Time_Set_to_True</name>
        <label>Is &quot;Defer to Location Open Time&quot; Set to True?</label>
        <locationX>824</locationX>
        <locationY>2447</locationY>
        <defaultConnector>
            <targetReference>Is_Start_Time_within_N_min</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_DeferToLocationOpenTimeIsTrue</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Defer_to_Location_Open_Time__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Pin_Service_Appointment</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the user that triggered the flow is the Field Service Optimization user, and if so, it does not auto-dispatch the Service Appointment.</description>
        <name>Is_Running_User_the_Optimizer</name>
        <label>Is Running User the Optimizer?</label>
        <locationX>600</locationX>
        <locationY>311</locationY>
        <defaultConnector>
            <targetReference>Get_Assigned_Resource_New</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_OptimizationUser</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$User.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Field Service Optimization</stringValue>
                </rightValue>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Start_Time_within_N_min</name>
        <label>Is Start Time within N min?</label>
        <locationX>1022</locationX>
        <locationY>2567</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.SchedStartTime</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>varCurrentTimePlusNMin</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Dispatch_Scheduled_Service_Appointment</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if the territory is live for WM Scheduling Enhancements.</description>
        <name>Live_with_WM_Enhancements</name>
        <label>Live with WM Enhancements?</label>
        <locationX>1401</locationX>
        <locationY>1967</locationY>
        <defaultConnectorLabel>Not Live</defaultConnectorLabel>
        <rules>
            <name>Live</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Territory_from_Service_Appointment.Live_with_WM_Scheduling_Enhancements__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Service_Resource_Shift</targetReference>
            </connector>
            <label>Live</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the Service Appointment was Scheduled or Dispatched.</description>
        <name>Scheduled_or_Dispatched</name>
        <label>Scheduled or Dispatched?</label>
        <locationX>1414</locationX>
        <locationY>1367</locationY>
        <defaultConnector>
            <targetReference>Set_Dispatched_Color</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Dispatched</defaultConnectorLabel>
        <rules>
            <name>Scheduled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Scheduled</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Emergency_0</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Scheduled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Status_Changed</name>
        <label>Status Changed?</label>
        <locationX>1414</locationX>
        <locationY>551</locationY>
        <defaultConnectorLabel>Status Not Changed</defaultConnectorLabel>
        <rules>
            <name>None</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSL__Schedule_over_lower_priority_appointment__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Schedule_Over_Lower_Priority_to_True</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>None</label>
        </rules>
        <rules>
            <name>Reject</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Rejected</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Rejected_by_and_Schedule_Over_Lower_Priority</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Rejected</label>
        </rules>
        <rules>
            <name>Scheduled2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Scheduled</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Assigned_Resource_Shift_USE</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Scheduled</label>
        </rules>
        <rules>
            <name>Dispatched</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Dispatched</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Assigned_Resource_Shift_USE</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Dispatched</label>
        </rules>
        <rules>
            <name>En_Route</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>En Route</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_En_Route_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>En Route</label>
        </rules>
        <rules>
            <name>On_Site</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>In Progress</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_On_Site_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>On Site</label>
        </rules>
        <rules>
            <name>Completed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Completed_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Completed</label>
        </rules>
        <rules>
            <name>Accepted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Accepted</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Accepted_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Accepted</label>
        </rules>
        <rules>
            <name>Agent_Appointment_or_Parts_on_Order</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Agent Appointment</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Parts On Order</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_RM_ATTN_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Agent Appointment or Parts on Order</label>
        </rules>
        <rules>
            <name>Location_Closed_or_Additional_Help_Required</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Location Closed</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Additional Help Required</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Call_Center_ATTN_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Location Closed or Additional Help Required</label>
        </rules>
        <rules>
            <name>Cannot_Complete</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Cannot Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Cannot_Complete_Color</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Cannot Complete</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if the Shift found was an overtime shift or not</description>
        <name>Was_Shift_Found_Overtime</name>
        <label>Was Shift Found Overtime?</label>
        <locationX>1414</locationX>
        <locationY>3623</locationY>
        <defaultConnector>
            <targetReference>Set_SA_OT_Shift_Variables_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Normal Shift Found</defaultConnectorLabel>
        <rules>
            <name>Overtime_Shift_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Assigned_Resource_Shift_USE.TimeSlotType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Extended</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_SA_OT_Shift_Variables</targetReference>
            </connector>
            <label>Overtime Shift Found</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>ConcatName</name>
        <dataType>String</dataType>
        <expression>&quot; &quot;+&quot;//&quot;+&quot; &quot;+{!$User.FirstName}+&quot; &quot;+{!$User.LastName}+&quot;:&quot;+ {!$Record.Tech_Notes_Mobile__c} +&quot; &quot;+&quot;//&quot;+&quot; &quot;</expression>
    </formulas>
    <formulas>
        <name>EstEndTime</name>
        <dataType>DateTime</dataType>
        <expression>{!CurrentTime} + ({!$Record.DurationInMinutes}/24/60)</expression>
    </formulas>
    <formulas>
        <description>Resource to return today&apos;s date</description>
        <name>TodayDate</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <formulas>
        <name>var60minBeforeShift</name>
        <dataType>DateTime</dataType>
        <expression>{!Get_Assigned_Resource_Shift_USE.StartTime}- (60/1440)</expression>
    </formulas>
    <formulas>
        <name>varCurrentTimePlusNMin</name>
        <dataType>DateTime</dataType>
        <expression>{!$Flow.CurrentDateTime} + 65/24/60</expression>
    </formulas>
    <interviewLabel>Service Appointment - Before Update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Service Appointment - Before Update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <description>Finds the Service Resource assigned to the Scheduled Service Appointment</description>
        <name>Get_Assigned_Resource_New</name>
        <label>Get Assigned Resource</label>
        <locationX>1414</locationX>
        <locationY>431</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Status_Changed</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ServiceAppointmentId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>AssignedResource</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Assigned_Resource_Shift_USE</name>
        <label>Get Assigned Resource Shift</label>
        <locationX>1414</locationX>
        <locationY>1247</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Scheduled_or_Dispatched</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ServiceResourceId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Assigned_Resource_New.ServiceResourceId</elementReference>
            </value>
        </filters>
        <filters>
            <field>StartTime</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.SchedStartTime</elementReference>
            </value>
        </filters>
        <filters>
            <field>EndTime</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.SchedEndTime</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Shift</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Finds today&apos;s scheduled Service Appointments for the Service Resource</description>
        <name>Get_Scheduled_Service_Appointments</name>
        <label>Get Scheduled Service Appointments</label>
        <locationX>1121</locationX>
        <locationY>2207</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Current_Time_within_Assigned_Shift</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND 6 AND (3 OR 4 OR 5) AND 7</filterLogic>
        <filters>
            <field>Service_Resource__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Assigned_Resource_New.ServiceResourceId</elementReference>
            </value>
        </filters>
        <filters>
            <field>SchedStartTime</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>Get_Assigned_Resource_Shift_USE.StartTime</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCategory</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Dispatched</stringValue>
            </value>
        </filters>
        <filters>
            <field>StatusCategory</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>InProgress</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Accepted</stringValue>
            </value>
        </filters>
        <filters>
            <field>SchedEndTime</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>Get_Assigned_Resource_Shift_USE.EndTime</elementReference>
            </value>
        </filters>
        <filters>
            <field>Defer_to_Location_Open_Time__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceAppointment</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Territory_from_Service_Appointment</name>
        <label>Get Territory from Service Appointment</label>
        <locationX>1401</locationX>
        <locationY>1847</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Live_with_WM_Enhancements</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ServiceTerritoryId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceTerritory</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>474</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Is_Running_User_the_Optimizer</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Work_Type_Name__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Service App Job</stringValue>
            </value>
        </filters>
        <object>ServiceAppointment</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>Counter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>CurrentTime</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>$Flow.CurrentDateTime</elementReference>
        </value>
    </variables>
</Flow>
